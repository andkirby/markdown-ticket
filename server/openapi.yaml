openapi: 3.0.0
info:
  title: Markdown Ticket API
  version: 1.0.0
  description: |-
    REST API for Markdown Ticket - an AI-powered Kanban board where tickets are markdown files.

    ## Key Features
    - **Multi-project support**: Manage CRs across multiple projects
    - **File-based storage**: All CRs stored as markdown files with YAML frontmatter
    - **Real-time updates**: SSE endpoint for live change notifications
    - **Git integration**: Version control for all ticket changes

    ## Authentication
    Currently, the API does not require authentication. Future versions may add API key or OAuth support.

    ## Error Handling
    All endpoints return consistent error responses with `error` and `message` fields.
  contact:
    name: Markdown Ticket
    url: 'https://github.com/example/markdown-ticket'
  license:
    name: MIT
    url: 'https://opensource.org/licenses/MIT'
servers:
  - url: 'http://localhost:3001'
    description: Development server
tags:
  - name: Projects
    description: Project management operations
  - name: CRs
    description: Change Request (ticket) operations
  - name: Documents
    description: Document discovery and management
  - name: Events
    description: Server-Sent Events for real-time updates
  - name: DevTools
    description: Development tools and logging endpoints
components:
  schemas:
    CRStatus:
      type: string
      enum:
        - Proposed
        - Approved
        - In Progress
        - Implemented
        - Rejected
        - On Hold
      description: Change Request status
      example: Proposed
    CRType:
      type: string
      enum:
        - Architecture
        - Feature Enhancement
        - Bug Fix
        - Technical Debt
        - Documentation
      description: Change Request type
      example: Feature Enhancement
    CRPriority:
      type: string
      enum:
        - Low
        - Medium
        - High
        - Critical
      description: Change Request priority level
      example: Medium
    CR:
      type: object
      required:
        - code
        - title
        - status
        - type
        - priority
      properties:
        code:
          type: string
          description: Unique CR identifier
          example: MDT-001
          pattern: '^[A-Z]+-\d{3,}$'
        title:
          type: string
          description: CR title
          example: Implement user authentication
        status:
          $ref: '#/components/schemas/CRStatus'
        type:
          $ref: '#/components/schemas/CRType'
        priority:
          $ref: '#/components/schemas/CRPriority'
        content:
          type: string
          description: Full markdown content of the CR
        phaseEpic:
          type: string
          description: Phase or epic this CR belongs to
          example: Phase 1
        dependsOn:
          type: string
          description: Comma-separated CR codes this depends on
          example: 'MDT-001, MDT-002'
        blocks:
          type: string
          description: Comma-separated CR codes blocked by this
          example: MDT-010
        assignee:
          type: string
          description: Person assigned to implement this CR
          example: john.doe
        relatedTickets:
          type: string
          description: Comma-separated related CR codes
          example: MDT-003
        impactAreas:
          type: array
          items:
            type: string
          description: System areas impacted
          example:
            - backend
            - api
        implementationDate:
          type: string
          format: date
          description: Date implementation completed (ISO 8601)
          example: 2025-09-20
        implementationNotes:
          type: string
          description: Notes about the implementation
    CRInput:
      type: object
      required:
        - title
        - type
      properties:
        title:
          type: string
          description: CR title
          example: Implement user authentication
        type:
          $ref: '#/components/schemas/CRType'
        priority:
          $ref: '#/components/schemas/CRPriority'
        content:
          type: string
          description: Full markdown content (template auto-generated if omitted)
        phaseEpic:
          type: string
        dependsOn:
          type: string
        blocks:
          type: string
        assignee:
          type: string
        relatedTickets:
          type: string
        impactAreas:
          type: array
          items:
            type: string
    Project:
      type: object
      required:
        - id
        - name
        - code
        - path
        - enabled
      properties:
        id:
          type: string
          description: Unique project identifier
          example: mdt
        name:
          type: string
          description: Project display name
          example: Markdown Ticket
        code:
          type: string
          description: Project code used in CR identifiers
          example: MDT
        path:
          type: string
          description: Absolute path to project directory
          example: /Users/dev/project
        enabled:
          type: boolean
          description: Whether the project is active
          example: true
        crPath:
          type: string
          description: Path to CR directory relative to project root
          example: docs/CRs
        documentPaths:
          type: array
          items:
            type: string
          description: Paths for document discovery
          example:
            - docs
        excludeFolders:
          type: array
          items:
            type: string
          description: Folders to exclude
          example:
            - node_modules
    Document:
      type: object
      required:
        - path
        - name
      properties:
        path:
          type: string
          description: Relative path from project root
          example: docs/architecture.md
        name:
          type: string
          description: Document filename
          example: architecture.md
        content:
          type: string
          description: Document content (when requested)
    Error400:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          example: Bad Request
        message:
          type: string
          example: Invalid request parameters
        details:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
              message:
                type: string
    Error404:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          example: Not Found
        message:
          type: string
          example: Resource not found
    Error500:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          example: Internal Server Error
        message:
          type: string
          example: An unexpected error occurred
    Error:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          example: Error
        message:
          type: string
          example: An error occurred
    ProjectConfig:
      type: object
      description: Project configuration from .mdt-config.toml
      properties:
        project:
          type: object
          properties:
            name:
              type: string
              example: Markdown Ticket
            code:
              type: string
              example: MDT
            crPath:
              type: string
              example: docs/CRs
        documentPaths:
          type: array
          items:
            type: string
          example:
            - docs
        excludeFolders:
          type: array
          items:
            type: string
          example:
            - node_modules
    LogEntry:
      type: object
      properties:
        timestamp:
          type: integer
          example: 1701234567890
        level:
          type: string
          enum:
            - info
            - warn
            - error
          example: info
        message:
          type: string
          example: Server started on port 3001
    FrontendLogEntry:
      type: object
      properties:
        timestamp:
          type: integer
          example: 1701234567890
        level:
          type: string
          example: info
        message:
          type: string
          example: Component mounted
        source:
          type: string
          example: console
        type:
          type: string
          example: log
        url:
          type: string
          example: 'http://localhost:5173/board'
        line:
          type: integer
          example: 42
        column:
          type: integer
          example: 15
    FrontendSessionStatus:
      type: object
      properties:
        active:
          type: boolean
          example: true
        sessionStart:
          type: integer
          nullable: true
          example: 1701234567890
        timeRemaining:
          type: integer
          nullable: true
          example: 1800000
    FrontendLogsResponse:
      type: object
      properties:
        logs:
          type: array
          items:
            $ref: '#/components/schemas/FrontendLogEntry'
        total:
          type: integer
          example: 150
    DevModeStatus:
      type: object
      properties:
        active:
          type: boolean
          example: true
        sessionStart:
          type: integer
          nullable: true
          example: 1701234567890
        timeRemaining:
          type: integer
          nullable: true
          example: 3600000
        rateLimit:
          type: object
          properties:
            limit:
              type: integer
              example: 300
            current:
              type: integer
              example: 42
            resetTime:
              type: integer
              example: 1701234627890
    DevModeLogResponse:
      type: object
      properties:
        received:
          type: integer
          example: 5
        rateLimit:
          type: object
          properties:
            remaining:
              type: integer
              example: 258
            resetTime:
              type: integer
              example: 1701234627890
    DevModeLogsResponse:
      type: object
      properties:
        logs:
          type: array
          items:
            $ref: '#/components/schemas/FrontendLogEntry'
        total:
          type: integer
          example: 150
        devMode:
          type: boolean
          example: true
        timeRemaining:
          type: integer
          nullable: true
          example: 3600000
  parameters:
    projectId:
      name: projectId
      in: path
      required: true
      schema:
        type: string
      description: Project identifier
      example: mdt
    crId:
      name: crId
      in: path
      required: true
      schema:
        type: string
        pattern: '^[A-Z]+-\d{3,}$'
      description: CR identifier
      example: MDT-001
    projectCode:
      name: code
      in: path
      required: true
      schema:
        type: string
        pattern: '^[A-Z]+$'
      description: Project code
      example: MDT
  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error400'
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error404'
    ServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error500'
    DevModeInactive:
      description: DEV mode not active
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: DEV mode not active
              message:
                type: string
                example: DEV mode logging is not currently active
    RateLimitExceeded:
      description: Rate limit exceeded
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Rate limit exceeded
              message:
                type: string
                example: DEV mode logging rate limit of 300 logs per minute exceeded
    CRCreated:
      description: CR created successfully
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CR'
    CRUpdated:
      description: CR updated successfully
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CR'
    ProjectCreated:
      description: Project created successfully
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Project'
    ProjectUpdated:
      description: Project updated successfully
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Project'
  requestBodies:
    CRCreate:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CRInput'
    CRPatch:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              status:
                $ref: '#/components/schemas/CRStatus'
              priority:
                $ref: '#/components/schemas/CRPriority'
              assignee:
                type: string
              phaseEpic:
                type: string
    CRUpdate:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CR'
    ProjectCreate:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - name
              - code
              - path
            properties:
              name:
                type: string
                example: My Project
              code:
                type: string
                example: PRJ
              path:
                type: string
                example: /path/to/project
              crPath:
                type: string
                example: docs/CRs
    ProjectUpdate:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              name:
                type: string
              crPath:
                type: string
              documentPaths:
                type: array
                items:
                  type: string
              excludeFolders:
                type: array
                items:
                  type: string
paths:
  /api/devtools/logs:
    get:
      tags:
        - DevTools
      summary: Get server logs
      parameters:
        - name: lines
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
        - name: filter
          in: query
          schema:
            type: string
          description: Case-insensitive text filter
      responses:
        '200':
          description: Array of log entries
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LogEntry'
  /api/devtools/logs/stream:
    get:
      tags:
        - DevTools
      summary: Stream server logs via SSE
      description: Server-Sent Events stream for real-time log monitoring
      parameters:
        - name: filter
          in: query
          schema:
            type: string
          description: Case-insensitive filter for log messages
      responses:
        '200':
          description: SSE stream with log events and heartbeats
          content:
            text/event-stream:
              schema:
                type: string
                example: 'data: {"type":"connected","message":"Log stream connected"}'
  /api/devtools/frontend/logs/status:
    get:
      tags:
        - DevTools
      summary: Get frontend logging session status
      description: Check if frontend logging session is active and time remaining
      responses:
        '200':
          description: Session status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FrontendSessionStatus'
  /api/devtools/frontend/logs/start:
    post:
      tags:
        - DevTools
      summary: Start frontend logging session
      description: Activate frontend log collection (30-minute timeout)
      responses:
        '200':
          description: Session started
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: started
                  sessionStart:
                    type: integer
                    example: 1701234567890
  /api/devtools/frontend/logs/stop:
    post:
      tags:
        - DevTools
      summary: Stop frontend logging session
      description: Deactivate frontend log collection
      responses:
        '200':
          description: Session stopped
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: stopped
  /api/devtools/frontend/logs:
    post:
      tags:
        - DevTools
      summary: Receive frontend logs
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                logs:
                  type: array
                  items:
                    $ref: '#/components/schemas/FrontendLogEntry'
      responses:
        '200':
          description: Logs received
          content:
            application/json:
              schema:
                type: object
                properties:
                  received:
                    type: integer
    get:
      tags:
        - DevTools
      summary: Get frontend logs
      parameters:
        - name: lines
          in: query
          schema:
            type: integer
            default: 20
            maximum: 1000
        - name: filter
          in: query
          schema:
            type: string
          description: Case-insensitive text filter
      responses:
        '200':
          description: Frontend logs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FrontendLogsResponse'
  /api/devtools/frontend/dev-logs/status:
    get:
      tags:
        - DevTools
      summary: Get DEV mode logging status
      description: Check DEV mode session status and rate limit info
      responses:
        '200':
          description: DEV mode status with rate limit info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DevModeStatus'
  /api/devtools/frontend/dev-logs:
    post:
      tags:
        - DevTools
      summary: 'Receive DEV mode logs (rate limited, 300/min)'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                logs:
                  type: array
                  items:
                    $ref: '#/components/schemas/FrontendLogEntry'
      responses:
        '200':
          description: Logs received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DevModeLogResponse'
        '403':
          $ref: '#/components/responses/DevModeInactive'
    get:
      tags:
        - DevTools
      summary: Get DEV mode logs
      parameters:
        - name: lines
          in: query
          schema:
            type: integer
            default: 20
            maximum: 1000
        - name: filter
          in: query
          schema:
            type: string
      responses:
        '200':
          description: DEV mode logs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DevModeLogsResponse'
        '403':
          $ref: '#/components/responses/DevModeInactive'
  /api-docs/json:
    get:
      tags:
        - Documentation
      summary: OpenAPI specification (JSON)
      description: Returns the raw OpenAPI 3.0.0 specification in JSON format
      responses:
        '200':
          description: OpenAPI specification
          content:
            application/json:
              schema:
                type: object
                description: OpenAPI 3.0.0 specification document
  /api-docs:
    get:
      tags:
        - Documentation
      summary: Interactive API documentation (Redoc UI)
      description: Serves Redoc UI for interactive API exploration
      responses:
        '200':
          description: Redoc HTML page
          content:
            text/html:
              schema:
                type: string
  /api/documents:
    get:
      summary: Discover documents for a project
      tags:
        - Documents
      parameters:
        - name: projectId
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: List of discovered documents
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Document'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/documents/content:
    get:
      summary: Get document content
      tags:
        - Documents
      parameters:
        - name: projectId
          in: query
          required: true
          schema:
            type: string
        - name: path
          in: query
          required: true
          schema:
            type: string
          description: Relative path to document
      responses:
        '200':
          description: Document content
          content:
            text/plain:
              schema:
                type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          description: Access denied or invalid file path
        '404':
          $ref: '#/components/responses/NotFound'
  /api/documents/configure:
    post:
      summary: Configure document paths for a project
      tags:
        - Documents
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - projectId
                - documentPaths
              properties:
                projectId:
                  type: string
                documentPaths:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Configuration updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/projects:
    get:
      summary: List all projects
      tags:
        - Projects
      parameters:
        - name: bypassCache
          in: query
          schema:
            type: boolean
            default: false
          description: Force cache refresh and reload all projects from disk
      responses:
        '200':
          description: List of all registered projects
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Project'
  '/api/projects/{projectId}/config':
    get:
      summary: Get project configuration
      tags:
        - Projects
      parameters:
        - $ref: '#/components/parameters/projectId'
      responses:
        '200':
          description: Project configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectConfig'
        '404':
          $ref: '#/components/responses/NotFound'
  '/api/projects/{projectId}/crs':
    get:
      summary: List CRs for project
      tags:
        - CRs
      parameters:
        - $ref: '#/components/parameters/projectId'
        - name: bypassCache
          in: query
          schema:
            type: boolean
            default: false
          description: Force cache refresh and reload all projects before fetching CRs
      responses:
        '200':
          description: List of CRs
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CR'
        '404':
          $ref: '#/components/responses/NotFound'
    post:
      summary: Create new CR
      tags:
        - CRs
      parameters:
        - $ref: '#/components/parameters/projectId'
      requestBody:
        $ref: '#/components/requestBodies/CRCreate'
      responses:
        '201':
          $ref: '#/components/responses/CRCreated'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
  '/api/projects/{projectId}/crs/{crId}':
    get:
      summary: Get specific CR
      tags:
        - CRs
      parameters:
        - $ref: '#/components/parameters/projectId'
        - $ref: '#/components/parameters/crId'
      responses:
        '200':
          description: CR details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CR'
        '404':
          $ref: '#/components/responses/NotFound'
    patch:
      summary: Partial update CR
      tags:
        - CRs
      parameters:
        - $ref: '#/components/parameters/projectId'
        - $ref: '#/components/parameters/crId'
      requestBody:
        $ref: '#/components/requestBodies/CRPatch'
      responses:
        '200':
          $ref: '#/components/responses/CRUpdated'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      summary: Full update CR
      tags:
        - CRs
      parameters:
        - $ref: '#/components/parameters/projectId'
        - $ref: '#/components/parameters/crId'
      requestBody:
        $ref: '#/components/requestBodies/CRUpdate'
      responses:
        '200':
          $ref: '#/components/responses/CRUpdated'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      summary: Delete CR
      tags:
        - CRs
      parameters:
        - $ref: '#/components/parameters/projectId'
        - $ref: '#/components/parameters/crId'
      responses:
        '204':
          description: CR deleted
        '404':
          $ref: '#/components/responses/NotFound'
  /api/projects/register:
    post:
      summary: Register project (deprecated)
      tags:
        - Projects
      deprecated: true
      responses:
        '501':
          description: Endpoint deprecated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/projects/create:
    post:
      summary: Create new project
      tags:
        - Projects
      requestBody:
        $ref: '#/components/requestBodies/ProjectCreate'
      responses:
        '201':
          $ref: '#/components/responses/ProjectCreated'
        '400':
          $ref: '#/components/responses/BadRequest'
  '/api/projects/{code}/update':
    put:
      summary: Update project
      tags:
        - Projects
      parameters:
        - $ref: '#/components/parameters/projectCode'
      requestBody:
        $ref: '#/components/requestBodies/ProjectUpdate'
      responses:
        '200':
          $ref: '#/components/responses/ProjectUpdated'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
  '/api/projects/{code}/enable':
    put:
      summary: Enable project
      tags:
        - Projects
      parameters:
        - $ref: '#/components/parameters/projectCode'
      responses:
        '200':
          description: Project enabled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
        '404':
          $ref: '#/components/responses/NotFound'
  '/api/projects/{code}/disable':
    put:
      summary: Disable project
      tags:
        - Projects
      parameters:
        - $ref: '#/components/parameters/projectCode'
      responses:
        '200':
          description: Project disabled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/events:
    get:
      summary: Server-Sent Events stream
      tags:
        - Events
      description: Real-time file change notifications via SSE
      responses:
        '200':
          description: SSE event stream
          content:
            text/event-stream:
              schema:
                type: string
                description: SSE formatted events
  /api/status:
    get:
      tags:
        - System
      summary: Server health status
      description: 'Returns server health, uptime info, and SSE client count'
      responses:
        '200':
          description: Server status
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
                  message:
                    type: string
                  tasksDir:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
                  sseClients:
                    type: integer
  /api/directories:
    get:
      tags:
        - System
      summary: System directories for path selection
      description: Returns home and common directories for project path browsing
      responses:
        '200':
          description: Directory list
          content:
            application/json:
              schema:
                type: object
                properties:
                  home:
                    type: string
                  directories:
                    type: array
                    items:
                      type: string
  /api/config/links:
    get:
      tags:
        - System
      summary: Get link configuration
      description: Returns link auto-detection and preview settings
      responses:
        '200':
          description: Link config
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: boolean
        '404':
          description: Config not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error404'
  /api/filesystem:
    get:
      tags:
        - System
      summary: Browse file system tree
      description: Returns directory tree for path selection UI
      parameters:
        - name: path
          in: query
          schema:
            type: string
          description: Root path to browse (defaults to home)
      responses:
        '200':
          description: File system tree
          content:
            application/json:
              schema:
                type: object
                properties:
                  path:
                    type: string
                  children:
                    type: array
                    items:
                      type: object
  /api/filesystem/exists:
    post:
      tags:
        - System
      summary: Check if directory exists
      description: Validates path existence and checks if within discovery paths
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - path
              properties:
                path:
                  type: string
                  description: Path to check (supports ~)
      responses:
        '200':
          description: Path status
          content:
            application/json:
              schema:
                type: object
                properties:
                  exists:
                    type: integer
                    enum:
                      - 0
                      - 1
                  isInDiscovery:
                    type: integer
                    enum:
                      - 0
                      - 1
                  expandedPath:
                    type: string
        '400':
          description: Invalid path
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error400'
  /api/cache/clear:
    post:
      tags:
        - System
      summary: Clear file operation cache
      description: Clears cached file operations to force fresh reads
      responses:
        '200':
          description: Cache cleared
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
  /api/config:
    get:
      tags:
        - System
      summary: Get frontend configuration
      description: Returns discovery settings for frontend display
      responses:
        '200':
          description: Config settings
          content:
            application/json:
              schema:
                type: object
                properties:
                  configDir:
                    type: string
                  discovery:
                    type: object
                    properties:
                      autoDiscover:
                        type: boolean
                      searchPaths:
                        type: array
                        items:
                          type: string
                      maxDepth:
                        type: integer
  /api/config/global:
    get:
      tags:
        - System
      summary: Get global configuration
      description: 'Returns full global config including discovery, links, ui, system settings'
      responses:
        '200':
          description: Full global config
          content:
            application/json:
              schema:
                type: object
                properties:
                  discovery:
                    type: object
                  links:
                    type: object
                  ui:
                    type: object
                  system:
                    type: object
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
  /api/config/clear:
    post:
      tags:
        - System
      summary: Clear config cache
      description: Clears project discovery and configuration cache
      responses:
        '200':
          description: Cache cleared
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
  /api/tasks:
    get:
      tags:
        - Tasks
      summary: List all task files
      description: Returns array of markdown filenames from the legacy tasks directory
      responses:
        '200':
          description: List of task filenames
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  example: task-001.md
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
  '/api/tasks/{filename}':
    get:
      tags:
        - Tasks
      summary: Get task file content
      description: Returns raw markdown content of a specific task file
      parameters:
        - name: filename
          in: path
          required: true
          schema:
            type: string
          example: task-001.md
      responses:
        '200':
          description: Task file content (raw markdown)
          content:
            text/plain:
              schema:
                type: string
        '400':
          description: Missing filename
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error400'
        '404':
          description: Task not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error404'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
    delete:
      tags:
        - Tasks
      summary: Delete task file
      description: Removes a task markdown file from the filesystem
      parameters:
        - name: filename
          in: path
          required: true
          schema:
            type: string
          example: task-001.md
      responses:
        '200':
          description: Task deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Missing filename
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error400'
        '404':
          description: Task not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error404'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
  /api/tasks/save:
    post:
      tags:
        - Tasks
      summary: Save task file
      description: Creates or updates a task markdown file
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - filename
                - content
              properties:
                filename:
                  type: string
                  example: task-001.md
                content:
                  type: string
                  description: Markdown content
      responses:
        '200':
          description: Task saved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  filename:
                    type: string
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error400'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
  '/api/duplicates/{projectId}':
    get:
      tags:
        - Duplicates
      summary: Get duplicate tickets (deprecated)
      description: |
        Finds tickets with identical or similar titles within a project.
        **Deprecated per MDT-082** - returns empty results.
      deprecated: true
      parameters:
        - $ref: '#/components/parameters/projectId'
      responses:
        '200':
          description: Duplicate detection results
          content:
            application/json:
              schema:
                type: object
                properties:
                  duplicates:
                    type: array
                    items:
                      type: object
                  totalDuplicates:
                    type: integer
                    example: 0
        '400':
          description: Missing project ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error400'
        '404':
          description: Project not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error404'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
  /api/duplicates/preview:
    post:
      tags:
        - Duplicates
      summary: Preview duplicate rename (deprecated)
      description: |
        Previews changes that would occur when renaming a duplicate ticket.
        **Deprecated per MDT-082** - returns empty results.
      deprecated: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - projectId
                - filepath
              properties:
                projectId:
                  type: string
                  example: mdt
                filepath:
                  type: string
                  example: docs/CRs/MDT-001.md
      responses:
        '200':
          description: Rename preview
          content:
            application/json:
              schema:
                type: object
                properties:
                  originalFilepath:
                    type: string
                  newFilepath:
                    type: string
                  oldCode:
                    type: string
                  newCode:
                    type: string
                  changesPreview:
                    type: string
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error400'
        '404':
          description: Project not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error404'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
  /api/duplicates/resolve:
    post:
      tags:
        - Duplicates
      summary: Resolve duplicate ticket (deprecated)
      description: |
        Resolves a duplicate by renaming or deleting the ticket.
        **Deprecated per MDT-082** - returns empty results.
      deprecated: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - projectId
                - oldFilepath
                - action
              properties:
                projectId:
                  type: string
                  example: mdt
                oldFilepath:
                  type: string
                  example: docs/CRs/MDT-001.md
                action:
                  type: string
                  enum:
                    - rename
                    - delete
                  example: rename
      responses:
        '200':
          description: Resolution result
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  action:
                    type: string
                  originalFilepath:
                    type: string
                  newFilepath:
                    type: string
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error400'
        '404':
          description: Project not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error404'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
